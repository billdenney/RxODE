
#ifndef linCmtB2g_header
#define linCmtB2g_header
#include "dual.h"

static inline dualN twoCmtRateSSr1G(double *A, double *r1, dualN *k10, dualN *k12, dualN *k21) {
dualN rx_dn0,rx_dn1,rx_dn2;
dualN E1;
assignD(&E1,add2(k10,k12,&rx_dn0));
dualN s;
assignD(&s,add2(&E1,k21,&rx_dn0));
dualN sqr;
assignD(&sqr,sqrtDX(subtr2X(prod2(&s,&s,&rx_dn0),prodd2X(4,(subtr2X(prod2(k21,&E1,&rx_dn1),prod2(k21,k12,&rx_dn2)))))));
dualN lambda1;
assignD(&lambda1,prodd2X(0.5,(add2(&s,&sqr,&rx_dn0))));
dualN lambda2;
assignD(&lambda2,prodd2X(0.5,(subtr2(&s,&sqr,&rx_dn0))));
dualN l12;
assignD(&l12,divd2X(1,(prod2(&lambda2,&lambda1,&rx_dn0))));
dualN A1;
assignD(&A1,prod2X(prodd2((*r1),k21,&rx_dn0),&l12));
dualN A2;
assignD(&A2,prod2X(prodd2((*r1),k12,&rx_dn0),&l12));
A[0] = A1.f;
A[1] = A2.f;
A[2] = A1.grad[dP1];
A[3] = A1.grad[dP2];
A[4] = A1.grad[dP3];
A[5] = A1.grad[dV1];
A[6] = A2.grad[dP1];
A[7] = A2.grad[dP2];
A[8] = A2.grad[dP3];
A[9] = A2.grad[dV1];
return A1;
}
static inline dualN twoCmtRateSSG(double *A, double *tinf, double *tau, double *r1, dualN *k10, dualN *k12, dualN *k21) {
dualN rx_dn0,rx_dn1,rx_dn2,rx_dn3,rx_dn4,rx_dn5,rx_dn6,rx_dn7,rx_dn8,rx_dn9,rx_dn10,rx_dn11,rx_dn12,rx_dn13,rx_dn14,rx_dn15,rx_dn16,rx_dn17,rx_dn18,rx_dn19,rx_dn20,rx_dn21,rx_dn22,rx_dn23,rx_dn24,rx_dn25,rx_dn26,rx_dn27,rx_dn28,rx_dn29,rx_dn30,rx_dn31,rx_dn32,rx_dn33,rx_dn34,rx_dn35,rx_dn36;
dualN E1;
assignD(&E1,add2(k10,k12,&rx_dn0));
dualN E2;
assignD(&E2,k21);
dualN s;
assignD(&s,add2(&E1,&E2,&rx_dn0));
dualN sqr;
assignD(&sqr,sqrtDX(subtr2X(prod2(&s,&s,&rx_dn0),prodd2X(4,(subtr2X(prod2(&E2,&E1,&rx_dn1),prod2(k21,k12,&rx_dn2)))))));
dualN lambda1;
assignD(&lambda1,prodd2X(0.5,(add2(&s,&sqr,&rx_dn0))));
dualN lambda2;
assignD(&lambda2,prodd2X(0.5,(subtr2(&s,&sqr,&rx_dn0))));
dualN eTi1;
assignD(&eTi1,expDX(prodd2(-(*tinf),&lambda1,&rx_dn0)));
dualN eTi2;
assignD(&eTi2,expDX(prodd2(-(*tinf),&lambda2,&rx_dn0)));
dualN eT1;
assignD(&eT1,div2X(expDX(prodd2X(((*tau)-(*tinf)),negD(&lambda1,&rx_dn0))),(subtrd2X(1,expDX(prodd2(-(*tau),&lambda1,&rx_dn1))))));
dualN eT2;
assignD(&eT2,div2X(expDX(prodd2X(((*tau)-(*tinf)),negD(&lambda2,&rx_dn0))),(subtrd2X(1,expDX(prodd2(-(*tau),&lambda2,&rx_dn1))))));
dualN A1;
assignD(&A1,div2X((subtr2X(prod2X2(&eT1,(add2X(subtr2X(prod2X2(&E2,(add2X(div2X((subtr2X(prod2d(&eTi1,(*r1),&rx_dn0),prod2d(&eTi2,(*r1),&rx_dn1))),(add2X(negD(&lambda1,&rx_dn2),&lambda2))),prod2X(prodd2((*r1),&E2,&rx_dn3),(subtr2X(add2X(divd2X(1,(prod2(&lambda2,&lambda1,&rx_dn4))),div2X2(&eTi1,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn5)),&lambda1)))),div2X2(&eTi2,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn6)),&lambda2))))))))),prod2X2(&lambda1,(add2X(div2X((subtr2X(prod2d(&eTi1,(*r1),&rx_dn7),prod2d(&eTi2,(*r1),&rx_dn8))),(add2X(negD(&lambda1,&rx_dn9),&lambda2))),prod2X(prodd2((*r1),&E2,&rx_dn10),(subtr2X(add2X(divd2X(1,(prod2(&lambda2,&lambda1,&rx_dn11))),div2X2(&eTi1,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn12)),&lambda1)))),div2X2(&eTi2,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn13)),&lambda2)))))))))),prod2X(prod2X(prodd2((*r1),k12,&rx_dn14),k21),(subtr2X(add2X(divd2X(1,(prod2(&lambda2,&lambda1,&rx_dn15))),div2X2(&eTi1,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn16)),&lambda1)))),div2X2(&eTi2,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn17)),&lambda2))))))))),prod2X2(&eT2,(add2X(subtr2X(prod2X2(&E2,(add2X(div2X((subtr2X(prod2d(&eTi1,(*r1),&rx_dn18),prod2d(&eTi2,(*r1),&rx_dn19))),(add2X(negD(&lambda1,&rx_dn20),&lambda2))),prod2X(prodd2((*r1),&E2,&rx_dn21),(subtr2X(add2X(divd2X(1,(prod2(&lambda2,&lambda1,&rx_dn22))),div2X2(&eTi1,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn23)),&lambda1)))),div2X2(&eTi2,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn24)),&lambda2))))))))),prod2X2(&lambda2,(add2X(div2X((subtr2X(prod2d(&eTi1,(*r1),&rx_dn25),prod2d(&eTi2,(*r1),&rx_dn26))),(add2X(negD(&lambda1,&rx_dn27),&lambda2))),prod2X(prodd2((*r1),&E2,&rx_dn28),(subtr2X(add2X(divd2X(1,(prod2(&lambda2,&lambda1,&rx_dn29))),div2X2(&eTi1,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn30)),&lambda1)))),div2X2(&eTi2,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn31)),&lambda2)))))))))),prod2X(prod2X(prodd2((*r1),k12,&rx_dn32),k21),(subtr2X(add2X(divd2X(1,(prod2(&lambda2,&lambda1,&rx_dn33))),div2X2(&eTi1,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn34)),&lambda1)))),div2X2(&eTi2,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn35)),&lambda2))))))))))),(add2X(negD(&lambda1,&rx_dn36),&lambda2))));
dualN A2;
assignD(&A2,div2X((subtr2X(prod2X2(&eT1,(subtr2X(add2X(prod2X2(k12,(add2X(div2X((subtr2X(prod2d(&eTi1,(*r1),&rx_dn0),prod2d(&eTi2,(*r1),&rx_dn1))),(add2X(negD(&lambda1,&rx_dn2),&lambda2))),prod2X(prodd2((*r1),&E2,&rx_dn3),(subtr2X(add2X(divd2X(1,(prod2(&lambda2,&lambda1,&rx_dn4))),div2X2(&eTi1,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn5)),&lambda1)))),div2X2(&eTi2,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn6)),&lambda2))))))))),prod2X(prod2X(prodd2((*r1),&E1,&rx_dn7),k12),(subtr2X(add2X(divd2X(1,(prod2(&lambda2,&lambda1,&rx_dn8))),div2X2(&eTi1,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn9)),&lambda1)))),div2X2(&eTi2,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn10)),&lambda2))))))),prod2X(prod2X(prodd2((*r1),k12,&rx_dn11),&lambda1),(subtr2X(add2X(divd2X(1,(prod2(&lambda2,&lambda1,&rx_dn12))),div2X2(&eTi1,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn13)),&lambda1)))),div2X2(&eTi2,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn14)),&lambda2))))))))),prod2X2(&eT2,(subtr2X(add2X(prod2X2(k12,(add2X(div2X((subtr2X(prod2d(&eTi1,(*r1),&rx_dn15),prod2d(&eTi2,(*r1),&rx_dn16))),(add2X(negD(&lambda1,&rx_dn17),&lambda2))),prod2X(prodd2((*r1),&E2,&rx_dn18),(subtr2X(add2X(divd2X(1,(prod2(&lambda2,&lambda1,&rx_dn19))),div2X2(&eTi1,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn20)),&lambda1)))),div2X2(&eTi2,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn21)),&lambda2))))))))),prod2X(prod2X(prodd2((*r1),&E1,&rx_dn22),k12),(subtr2X(add2X(divd2X(1,(prod2(&lambda2,&lambda1,&rx_dn23))),div2X2(&eTi1,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn24)),&lambda1)))),div2X2(&eTi2,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn25)),&lambda2))))))),prod2X(prod2X(prodd2((*r1),k12,&rx_dn26),&lambda2),(subtr2X(add2X(divd2X(1,(prod2(&lambda2,&lambda1,&rx_dn27))),div2X2(&eTi1,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn28)),&lambda1)))),div2X2(&eTi2,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn29)),&lambda2))))))))))),(add2X(negD(&lambda1,&rx_dn30),&lambda2))));
A[0] = A1.f;
A[1] = A2.f;
A[2] = A1.grad[dP1];
A[3] = A1.grad[dP2];
A[4] = A1.grad[dP3];
A[5] = A1.grad[dV1];
A[6] = A2.grad[dP1];
A[7] = A2.grad[dP2];
A[8] = A2.grad[dP3];
A[9] = A2.grad[dV1];
return A1;
}
static inline dualN twoCmtRateG(double *A, double *Alast, double *t, double *b1, double *r1, dualN *k10, dualN *k12, dualN *k21) {
dualN rx_dn0,rx_dn1,rx_dn2,rx_dn3;
dualN A1last;
A1last.f = Alast[0];
A1last.grad[dP1] = Alast[2];
A1last.grad[dP2] = Alast[3];
A1last.grad[dP3] = Alast[4];
A1last.grad[dV1] = Alast[5];
dualN A2last;
A2last.f=Alast[1];
A2last.grad[dP1] = Alast[5];
A2last.grad[dP2] = Alast[6];
A2last.grad[dP3] = Alast[7];
A2last.grad[dV1] = Alast[8];
dualN E1;
assignD(&E1,add2(k10,k12,&rx_dn0));
dualN E2;
assignD(&E2,k21);
dualN s;
assignD(&s,add2(&E1,&E2,&rx_dn0));
dualN sqr;
assignD(&sqr,sqrtDX(subtr2X(prod2(&s,&s,&rx_dn0),prodd2X(4,(subtr2X(prod2(&E2,&E1,&rx_dn1),prod2(k21,k12,&rx_dn2)))))));
dualN lambda1;
assignD(&lambda1,prodd2X(0.5,(add2(&s,&sqr,&rx_dn0))));
dualN lambda2;
assignD(&lambda2,prodd2X(0.5,(subtr2(&s,&sqr,&rx_dn0))));
dualN eT1;
assignD(&eT1,expDX(prodd2(-(*t),&lambda1,&rx_dn0)));
dualN eT2;
assignD(&eT2,expDX(prodd2(-(*t),&lambda2,&rx_dn0)));
dualN l12;
assignD(&l12,(subtr2(&lambda1,&lambda2,&rx_dn0)));
dualN l21;
assignD(&l21,(subtr2(&lambda2,&lambda1,&rx_dn0)));
dualN c10;
assignD(&c10,(add2X(add2dX(prod2(&E2,&A1last,&rx_dn0),(*r1)),prod2(k21,&A2last,&rx_dn1))));
dualN c11;
assignD(&c11,div2X((subtr2X2(&c10,prod2(&lambda1,&A1last,&rx_dn0))),&l21));
dualN c12;
assignD(&c12,div2X((subtr2X2(&c10,prod2(&lambda2,&A1last,&rx_dn0))),&l21));
dualN A1term1;
assignD(&A1term1,subtr2X(prod2(&eT1,&c11,&rx_dn0),prod2(&eT2,&c12,&rx_dn1)));
dualN A1term2;
assignD(&A1term2,prod2X(prodd2((*r1),&E2,&rx_dn0),(subtr2X(add2X(divd2X(1,(prod2(&lambda2,&lambda1,&rx_dn1))),div2X2(&eT1,(prod2(&l12,&lambda1,&rx_dn2)))),div2X2(&eT2,(prod2(&l12,&lambda2,&rx_dn3)))))));
dualN A1;
assignD(&A1,add2dX(add2(&A1term1,&A1term2,&rx_dn0),(*b1)));
dualN c20;
assignD(&c20,(add2X(prod2(&E1,&A2last,&rx_dn0),prod2(k12,&A1last,&rx_dn1))));
dualN c21;
assignD(&c21,div2X((subtr2X2(&c20,prod2(&lambda1,&A2last,&rx_dn0))),&l21));
dualN c22;
assignD(&c22,div2X((subtr2X2(&c20,prod2(&lambda2,&A2last,&rx_dn0))),&l21));
dualN A2term1;
assignD(&A2term1,subtr2X(prod2(&eT1,&c21,&rx_dn0),prod2(&eT2,&c22,&rx_dn1)));
dualN A2term2;
assignD(&A2term2,prod2X(prodd2((*r1),k12,&rx_dn0),(subtr2X(add2X(divd2X(1,(prod2(&lambda2,&lambda1,&rx_dn1))),div2X2(&eT1,(prod2(&l12,&lambda1,&rx_dn2)))),div2X2(&eT2,(prod2X2(&lambda2,(subtr2(&lambda1,&lambda2,&rx_dn3)))))))));
dualN A2;
assignD(&A2,add2(&A2term1,&A2term2,&rx_dn0));
A[0] = A1.f;
A[1] = A2.f;
A[2] = A1.grad[dP1];
A[3] = A1.grad[dP2];
A[4] = A1.grad[dP3];
A[5] = A1.grad[dV1];
A[6] = A2.grad[dP1];
A[7] = A2.grad[dP2];
A[8] = A2.grad[dP3];
A[9] = A2.grad[dV1];
return A1;
}
static inline dualN twoCmtBolusSSG(double *A, double *tau, double *b1, dualN *k10, dualN *k12, dualN *k21) {
dualN rx_dn0,rx_dn1,rx_dn2,rx_dn3,rx_dn4;
dualN E2;
assignD(&E2,k21);
dualN s;
assignD(&s,add2X(add2(k12,k21,&rx_dn0),k10));
dualN sqr;
assignD(&sqr,sqrtDX(subtr2X(prod2(&s,&s,&rx_dn0),prod2X(prodd2(4,k21,&rx_dn1),k10))));
dualN lambda1;
assignD(&lambda1,prodd2X(0.5,(add2(&s,&sqr,&rx_dn0))));
dualN lambda2;
assignD(&lambda2,prodd2X(0.5,(subtr2(&s,&sqr,&rx_dn0))));
dualN eL1;
assignD(&eL1,divd2X(1,(subtrd2X(1,expDX(prodd2(-(*tau),&lambda1,&rx_dn0))))));
dualN eL2;
assignD(&eL2,divd2X(1,(subtrd2X(1,expDX(prodd2(-(*tau),&lambda2,&rx_dn0))))));
dualN A1;
assignD(&A1,div2X((subtr2X(prod2X2(&eL1,(subtr2X(prodd2((*b1),&E2,&rx_dn0),prodd2((*b1),&lambda1,&rx_dn1)))),prod2X2(&eL2,(subtr2X(prodd2((*b1),&E2,&rx_dn2),prodd2((*b1),&lambda2,&rx_dn3)))))),(add2X(negD(&lambda1,&rx_dn4),&lambda2))));
dualN A2;
assignD(&A2,div2X((subtr2X(prod2X(prod2d(&eL1,(*b1),&rx_dn0),k12),prod2X(prod2d(&eL2,(*b1),&rx_dn1),k12))),(add2X(negD(&lambda1,&rx_dn2),&lambda2))));
A[0] = A1.f;
A[1] = A2.f;
A[2] = A1.grad[dP1];
A[3] = A1.grad[dP2];
A[4] = A1.grad[dP3];
A[5] = A1.grad[dV1];
A[6] = A2.grad[dP1];
A[7] = A2.grad[dP2];
A[8] = A2.grad[dP3];
A[9] = A2.grad[dV1];
return A1;
}
static inline dualN twoCmtKaRateSSr1G(double *A, double *r1, dualN *ka, dualN *k20, dualN *k23, dualN *k32) {
dualN rx_dn0,rx_dn1;
//has ka
dualN s;
assignD(&s,add2X(add2(k23,k32,&rx_dn0),k20));
dualN beta;
assignD(&beta,prodd2X(0.5,(subtr2X2(&s,sqrtDX(subtr2X(prod2(&s,&s,&rx_dn0),prod2X(prodd2(4,k32,&rx_dn1),k20)))))));
dualN alpha;
assignD(&alpha,div2X(prod2(k20,k32,&rx_dn0),&beta));
dualN A1;
assignD(&A1,divd2((*r1),ka,&rx_dn0));
dualN A2;
assignD(&A2,div2X(prodd2((*r1),k32,&rx_dn0),(prod2(&alpha,&beta,&rx_dn1))));
dualN A3;
assignD(&A3,div2X(prodd2((*r1),k23,&rx_dn0),(prod2(&alpha,&beta,&rx_dn1))));
A[0] = A1.f;
A[1] = A2.f;
A[2] = A3.f;
A[3] = A1.grad[dKa];
A[4] = A1.grad[dP1];
A[5] = A1.grad[dP2];
A[6] = A1.grad[dP3];
A[7] = A1.grad[dV1];
A[8]  = A2.grad[dKa];
A[9]  = A2.grad[dP1];
A[10] = A2.grad[dP2];
A[11] = A2.grad[dP3];
A[12] = A2.grad[dV1];
A[13] = A3.grad[dKa];
A[14] = A3.grad[dP1];
A[15] = A3.grad[dP2];
A[16] = A3.grad[dP3];
A[17] = A3.grad[dV1];
return A2;
}
static inline dualN twoCmtKaRateSSr2G(double *A, double *r2, dualN *ka, dualN *k20, dualN *k23, dualN *k32) {
dualN rx_dn0,rx_dn1;
(void)(ka);
dualN s;
assignD(&s,add2X(add2(k23,k32,&rx_dn0),k20));
dualN beta;
assignD(&beta,prodd2X(0.5,(subtr2X2(&s,sqrtDX(subtr2X(prod2(&s,&s,&rx_dn0),prod2X(prodd2(4,k32,&rx_dn1),k20)))))));
dualN alpha;
assignD(&alpha,div2X(prod2(k20,k32,&rx_dn0),&beta));
dualN A1;
iniD(0, -1, &A1);
dualN A2;
assignD(&A2,div2X(prodd2((*r2),k32,&rx_dn0),(prod2(&alpha,&beta,&rx_dn1))));
dualN A3;
assignD(&A3,div2X(prodd2((*r2),k23,&rx_dn0),(prod2(&alpha,&beta,&rx_dn1))));
A[0] = A1.f;
A[1] = A2.f;
A[2] = A3.f;
A[3] = A1.grad[dKa];
A[4] = A1.grad[dP1];
A[5] = A1.grad[dP2];
A[6] = A1.grad[dP3];
A[7] = A1.grad[dV1];
A[8]  = A2.grad[dKa];
A[9]  = A2.grad[dP1];
A[10] = A2.grad[dP2];
A[11] = A2.grad[dP3];
A[12] = A2.grad[dV1];
A[13] = A3.grad[dKa];
A[14] = A3.grad[dP1];
A[15] = A3.grad[dP2];
A[16] = A3.grad[dP3];
A[17] = A3.grad[dV1];
return A2;
}
static inline dualN twoCmtKaRateSStr1G(double *A, double *tinf, double *tau, double *r1, dualN *ka, dualN *k20, dualN *k23, dualN *k32) {
dualN rx_dn0,rx_dn1,rx_dn2,rx_dn3,rx_dn4,rx_dn5,rx_dn6,rx_dn7,rx_dn8,rx_dn9,rx_dn10,rx_dn11,rx_dn12,rx_dn13,rx_dn14,rx_dn15,rx_dn16,rx_dn17,rx_dn18,rx_dn19,rx_dn20,rx_dn21,rx_dn22,rx_dn23,rx_dn24,rx_dn25,rx_dn26,rx_dn27,rx_dn28,rx_dn29,rx_dn30,rx_dn31,rx_dn32,rx_dn33,rx_dn34,rx_dn35,rx_dn36,rx_dn37,rx_dn38,rx_dn39,rx_dn40,rx_dn41,rx_dn42,rx_dn43,rx_dn44,rx_dn45,rx_dn46,rx_dn47,rx_dn48,rx_dn49,rx_dn50,rx_dn51,rx_dn52,rx_dn53,rx_dn54,rx_dn55,rx_dn56,rx_dn57,rx_dn58,rx_dn59,rx_dn60,rx_dn61,rx_dn62,rx_dn63,rx_dn64,rx_dn65,rx_dn66,rx_dn67,rx_dn68,rx_dn69,rx_dn70,rx_dn71,rx_dn72,rx_dn73,rx_dn74,rx_dn75,rx_dn76,rx_dn77,rx_dn78,rx_dn79,rx_dn80,rx_dn81,rx_dn82,rx_dn83,rx_dn84,rx_dn85,rx_dn86,rx_dn87,rx_dn88,rx_dn89,rx_dn90,rx_dn91;
//has ka
dualN s;
assignD(&s,add2X(add2(k23,k32,&rx_dn0),k20));
dualN beta;
assignD(&beta,prodd2X(0.5,(subtr2X2(&s,sqrtDX(subtr2X(prod2(&s,&s,&rx_dn0),prod2X(prodd2(4,k32,&rx_dn1),k20)))))));
dualN alpha;
assignD(&alpha,div2X(prod2(k20,k32,&rx_dn0),&beta));
dualN eA;
assignD(&eA,div2X(expDX(prodd2X(((*tau)-(*tinf)),negD(&alpha,&rx_dn0))),(subtrd2X(1,expDX(prod2dX(negD(&alpha,&rx_dn1),(*tau)))))));
dualN eB;
assignD(&eB,div2X(expDX(prodd2X(((*tau)-(*tinf)),negD(&beta,&rx_dn0))),(subtrd2X(1,expDX(prod2dX(negD(&beta,&rx_dn1),(*tau)))))));
dualN eiA;
assignD(&eiA,expDX(prod2dX(negD(&alpha,&rx_dn0),(*tinf))));
dualN eiB;
assignD(&eiB,expDX(prod2dX(negD(&beta,&rx_dn0),(*tinf))));
dualN alpha2;
assignD(&alpha2,prod2(&alpha,&alpha,&rx_dn0));
dualN alpha3;
assignD(&alpha3,prod2(&alpha,&alpha2,&rx_dn0));
dualN beta2;
assignD(&beta2,prod2(&beta,&beta,&rx_dn0));
dualN beta3;
assignD(&beta3,prod2(&beta,&beta2,&rx_dn0));
dualN ka2;
assignD(&ka2,prod2(ka,ka,&rx_dn0));
dualN eKa;
assignD(&eKa,div2X(expDX(prodd2X(((*tau)-(*tinf)),negD(ka,&rx_dn0))),(subtrd2X(1,expDX(prod2dX(negD(ka,&rx_dn1),(*tau)))))));
dualN eiKa;
assignD(&eiKa,expDX(prod2dX(negD(ka,&rx_dn0),(*tinf))));
dualN A1;
assignD(&A1,prod2X2(&eKa,(subtr2X(divd2((*r1),ka,&rx_dn0),div2X(prod2d(&eiKa,(*r1),&rx_dn1),ka)))));
dualN A2;
assignD(&A2,add2X(div2X((subtr2X(prod2X2(&eA,(add2X(add2X(prod2X(negD(&alpha,&rx_dn0),(add2X(subtr2X(add2X(div2X(prodd2((*r1),k32,&rx_dn1),(prod2(&alpha,&beta,&rx_dn2))),div2X(prod2X(prod2d(&eiKa,(*r1),&rx_dn3),(add2X(negD(k32,&rx_dn4),ka))),(add2X(add2X(prod2(&alpha,&beta,&rx_dn5),prod2X2(ka,(subtr2X(negD(&alpha,&rx_dn6),&beta)))),&ka2)))),div2X(prod2X(prod2X(prod2d(&eiA,(*r1),&rx_dn7),ka),(add2X(negD(&alpha,&rx_dn8),k32))),(add2X(add2X(prod2X(negD(&beta,&rx_dn9),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn10),&alpha2)))),&alpha3)))),div2X(prod2X(prod2X(prod2d(&eiB,(*r1),&rx_dn11),ka),(add2X(negD(&beta,&rx_dn12),k32))),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn13),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn14),&alpha),&beta2)))),&beta3)))))),prod2X2(k32,(add2X(subtr2X(subtr2X(div2X(prodd2((*r1),k23,&rx_dn15),(prod2(&alpha,&beta,&rx_dn16))),div2X(prod2X(prod2d(&eiKa,(*r1),&rx_dn17),k23),(add2X(add2X(prod2(&alpha,&beta,&rx_dn18),prod2X2(ka,(subtr2X(negD(&alpha,&rx_dn19),&beta)))),&ka2)))),div2X(prod2X(prod2X(prod2d(&eiA,(*r1),&rx_dn20),ka),k23),(add2X(add2X(prod2X(negD(&beta,&rx_dn21),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn22),&alpha2)))),&alpha3)))),div2X(prod2X(prod2X(prod2d(&eiB,(*r1),&rx_dn23),ka),k23),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn24),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn25),&alpha),&beta2)))),&beta3))))))),prod2X2(k32,(add2X(subtr2X(add2X(div2X(prodd2((*r1),k32,&rx_dn26),(prod2(&alpha,&beta,&rx_dn27))),div2X(prod2X(prod2d(&eiKa,(*r1),&rx_dn28),(add2X(negD(k32,&rx_dn29),ka))),(add2X(add2X(prod2(&alpha,&beta,&rx_dn30),prod2X2(ka,(subtr2X(negD(&alpha,&rx_dn31),&beta)))),&ka2)))),div2X(prod2X(prod2X(prod2d(&eiA,(*r1),&rx_dn32),ka),(add2X(negD(&alpha,&rx_dn33),k32))),(add2X(add2X(prod2X(negD(&beta,&rx_dn34),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn35),&alpha2)))),&alpha3)))),div2X(prod2X(prod2X(prod2d(&eiB,(*r1),&rx_dn36),ka),(add2X(negD(&beta,&rx_dn37),k32))),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn38),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn39),&alpha),&beta2)))),&beta3))))))))),prod2X2(&eB,(add2X(add2X(prod2X(negD(&beta,&rx_dn40),(add2X(subtr2X(add2X(div2X(prodd2((*r1),k32,&rx_dn41),(prod2(&alpha,&beta,&rx_dn42))),div2X(prod2X(prod2d(&eiKa,(*r1),&rx_dn43),(add2X(negD(k32,&rx_dn44),ka))),(add2X(add2X(prod2(&alpha,&beta,&rx_dn45),prod2X2(ka,(subtr2X(negD(&alpha,&rx_dn46),&beta)))),&ka2)))),div2X(prod2X(prod2X(prod2d(&eiA,(*r1),&rx_dn47),ka),(add2X(negD(&alpha,&rx_dn48),k32))),(add2X(add2X(prod2X(negD(&beta,&rx_dn49),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn50),&alpha2)))),&alpha3)))),div2X(prod2X(prod2X(prod2d(&eiB,(*r1),&rx_dn51),ka),(add2X(negD(&beta,&rx_dn52),k32))),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn53),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn54),&alpha),&beta2)))),&beta3)))))),prod2X2(k32,(add2X(subtr2X(subtr2X(div2X(prodd2((*r1),k23,&rx_dn55),(prod2(&alpha,&beta,&rx_dn56))),div2X(prod2X(prod2d(&eiKa,(*r1),&rx_dn57),k23),(add2X(add2X(prod2(&alpha,&beta,&rx_dn58),prod2X2(ka,(subtr2X(negD(&alpha,&rx_dn59),&beta)))),&ka2)))),div2X(prod2X(prod2X(prod2d(&eiA,(*r1),&rx_dn60),ka),k23),(add2X(add2X(prod2X(negD(&beta,&rx_dn61),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn62),&alpha2)))),&alpha3)))),div2X(prod2X(prod2X(prod2d(&eiB,(*r1),&rx_dn63),ka),k23),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn64),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn65),&alpha),&beta2)))),&beta3))))))),prod2X2(k32,(add2X(subtr2X(add2X(div2X(prodd2((*r1),k32,&rx_dn66),(prod2(&alpha,&beta,&rx_dn67))),div2X(prod2X(prod2d(&eiKa,(*r1),&rx_dn68),(add2X(negD(k32,&rx_dn69),ka))),(add2X(add2X(prod2(&alpha,&beta,&rx_dn70),prod2X2(ka,(subtr2X(negD(&alpha,&rx_dn71),&beta)))),&ka2)))),div2X(prod2X(prod2X(prod2d(&eiA,(*r1),&rx_dn72),ka),(add2X(negD(&alpha,&rx_dn73),k32))),(add2X(add2X(prod2X(negD(&beta,&rx_dn74),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn75),&alpha2)))),&alpha3)))),div2X(prod2X(prod2X(prod2d(&eiB,(*r1),&rx_dn76),ka),(add2X(negD(&beta,&rx_dn77),k32))),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn78),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn79),&alpha),&beta2)))),&beta3))))))))))),(add2X(negD(&alpha,&rx_dn80),&beta))),prod2X(prod2X2(ka,(add2X(add2X(div2X(prod2X2(&eA,(add2X(negD(&alpha,&rx_dn81),k32))),(prod2X((add2X(negD(&alpha,&rx_dn82),&beta)),(add2X(negD(&alpha,&rx_dn83),ka))))),div2X(prod2X2(&eB,(add2X(negD(&beta,&rx_dn84),k32))),(prod2X((add2X(negD(&beta,&rx_dn85),ka)),(subtr2(&alpha,&beta,&rx_dn86)))))),div2X(prod2X2(&eKa,(subtr2(k32,ka,&rx_dn87))),(prod2X((subtr2(&beta,ka,&rx_dn88)),(subtr2(&alpha,ka,&rx_dn89)))))))),(subtr2X(divd2((*r1),ka,&rx_dn90),div2X(prod2d(&eiKa,(*r1),&rx_dn91),ka))))));
dualN A3;
assignD(&A3,add2X(div2X((subtr2X(prod2X2(&eA,(add2X(add2X(prod2X(negD(&alpha,&rx_dn0),(add2X(subtr2X(subtr2X(div2X(prodd2((*r1),k23,&rx_dn1),(prod2(&alpha,&beta,&rx_dn2))),div2X(prod2X(prod2d(&eiKa,(*r1),&rx_dn3),k23),(add2X(add2X(prod2(&alpha,&beta,&rx_dn4),prod2X2(ka,(subtr2X(negD(&alpha,&rx_dn5),&beta)))),&ka2)))),div2X(prod2X(prod2X(prod2d(&eiA,(*r1),&rx_dn6),ka),k23),(add2X(add2X(prod2X(negD(&beta,&rx_dn7),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn8),&alpha2)))),&alpha3)))),div2X(prod2X(prod2X(prod2d(&eiB,(*r1),&rx_dn9),ka),k23),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn10),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn11),&alpha),&beta2)))),&beta3)))))),prod2X2(k23,(add2X(subtr2X(add2X(div2X(prodd2((*r1),k32,&rx_dn12),(prod2(&alpha,&beta,&rx_dn13))),div2X(prod2X(prod2d(&eiKa,(*r1),&rx_dn14),(add2X(negD(k32,&rx_dn15),ka))),(add2X(add2X(prod2(&alpha,&beta,&rx_dn16),prod2X2(ka,(subtr2X(negD(&alpha,&rx_dn17),&beta)))),&ka2)))),div2X(prod2X(prod2X(prod2d(&eiA,(*r1),&rx_dn18),ka),(add2X(negD(&alpha,&rx_dn19),k32))),(add2X(add2X(prod2X(negD(&beta,&rx_dn20),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn21),&alpha2)))),&alpha3)))),div2X(prod2X(prod2X(prod2d(&eiB,(*r1),&rx_dn22),ka),(add2X(negD(&beta,&rx_dn23),k32))),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn24),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn25),&alpha),&beta2)))),&beta3))))))),prod2X((add2(k20,k23,&rx_dn26)),(add2X(subtr2X(subtr2X(div2X(prodd2((*r1),k23,&rx_dn27),(prod2(&alpha,&beta,&rx_dn28))),div2X(prod2X(prod2d(&eiKa,(*r1),&rx_dn29),k23),(add2X(add2X(prod2(&alpha,&beta,&rx_dn30),prod2X2(ka,(subtr2X(negD(&alpha,&rx_dn31),&beta)))),&ka2)))),div2X(prod2X(prod2X(prod2d(&eiA,(*r1),&rx_dn32),ka),k23),(add2X(add2X(prod2X(negD(&beta,&rx_dn33),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn34),&alpha2)))),&alpha3)))),div2X(prod2X(prod2X(prod2d(&eiB,(*r1),&rx_dn35),ka),k23),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn36),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn37),&alpha),&beta2)))),&beta3))))))))),prod2X2(&eB,(add2X(add2X(prod2X(negD(&beta,&rx_dn38),(add2X(subtr2X(subtr2X(div2X(prodd2((*r1),k23,&rx_dn39),(prod2(&alpha,&beta,&rx_dn40))),div2X(prod2X(prod2d(&eiKa,(*r1),&rx_dn41),k23),(add2X(add2X(prod2(&alpha,&beta,&rx_dn42),prod2X2(ka,(subtr2X(negD(&alpha,&rx_dn43),&beta)))),&ka2)))),div2X(prod2X(prod2X(prod2d(&eiA,(*r1),&rx_dn44),ka),k23),(add2X(add2X(prod2X(negD(&beta,&rx_dn45),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn46),&alpha2)))),&alpha3)))),div2X(prod2X(prod2X(prod2d(&eiB,(*r1),&rx_dn47),ka),k23),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn48),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn49),&alpha),&beta2)))),&beta3)))))),prod2X2(k23,(add2X(subtr2X(add2X(div2X(prodd2((*r1),k32,&rx_dn50),(prod2(&alpha,&beta,&rx_dn51))),div2X(prod2X(prod2d(&eiKa,(*r1),&rx_dn52),(add2X(negD(k32,&rx_dn53),ka))),(add2X(add2X(prod2(&alpha,&beta,&rx_dn54),prod2X2(ka,(subtr2X(negD(&alpha,&rx_dn55),&beta)))),&ka2)))),div2X(prod2X(prod2X(prod2d(&eiA,(*r1),&rx_dn56),ka),(add2X(negD(&alpha,&rx_dn57),k32))),(add2X(add2X(prod2X(negD(&beta,&rx_dn58),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn59),&alpha2)))),&alpha3)))),div2X(prod2X(prod2X(prod2d(&eiB,(*r1),&rx_dn60),ka),(add2X(negD(&beta,&rx_dn61),k32))),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn62),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn63),&alpha),&beta2)))),&beta3))))))),prod2X((add2(k20,k23,&rx_dn64)),(add2X(subtr2X(subtr2X(div2X(prodd2((*r1),k23,&rx_dn65),(prod2(&alpha,&beta,&rx_dn66))),div2X(prod2X(prod2d(&eiKa,(*r1),&rx_dn67),k23),(add2X(add2X(prod2(&alpha,&beta,&rx_dn68),prod2X2(ka,(subtr2X(negD(&alpha,&rx_dn69),&beta)))),&ka2)))),div2X(prod2X(prod2X(prod2d(&eiA,(*r1),&rx_dn70),ka),k23),(add2X(add2X(prod2X(negD(&beta,&rx_dn71),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn72),&alpha2)))),&alpha3)))),div2X(prod2X(prod2X(prod2d(&eiB,(*r1),&rx_dn73),ka),k23),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn74),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn75),&alpha),&beta2)))),&beta3))))))))))),(add2X(negD(&alpha,&rx_dn76),&beta))),prod2X(prod2X(prod2(k23,ka,&rx_dn77),(add2X(add2X(div2X2(&eA,(prod2X((add2X(negD(&alpha,&rx_dn78),&beta)),(add2X(negD(&alpha,&rx_dn79),ka))))),div2X2(&eB,(prod2X((add2X(negD(&beta,&rx_dn80),ka)),(subtr2(&alpha,&beta,&rx_dn81)))))),div2X2(&eKa,(prod2X((subtr2(&beta,ka,&rx_dn82)),(subtr2(&alpha,ka,&rx_dn83)))))))),(subtr2X(divd2((*r1),ka,&rx_dn84),div2X(prod2d(&eiKa,(*r1),&rx_dn85),ka))))));
A[0] = A1.f;
A[1] = A2.f;
A[2] = A3.f;
A[3] = A1.grad[dKa];
A[4] = A1.grad[dP1];
A[5] = A1.grad[dP2];
A[6] = A1.grad[dP3];
A[7] = A1.grad[dV1];
A[8]  = A2.grad[dKa];
A[9]  = A2.grad[dP1];
A[10] = A2.grad[dP2];
A[11] = A2.grad[dP3];
A[12] = A2.grad[dV1];
A[13] = A3.grad[dKa];
A[14] = A3.grad[dP1];
A[15] = A3.grad[dP2];
A[16] = A3.grad[dP3];
A[17] = A3.grad[dV1];
return A2;
}
static inline dualN twoCmtKaRateSStr2G(double *A, double *tinf, double *tau, double *r2, dualN *ka, dualN *k20, dualN *k23, dualN *k32) {
dualN rx_dn0,rx_dn1,rx_dn2,rx_dn3,rx_dn4,rx_dn5,rx_dn6,rx_dn7,rx_dn8,rx_dn9,rx_dn10,rx_dn11,rx_dn12,rx_dn13,rx_dn14,rx_dn15,rx_dn16,rx_dn17,rx_dn18,rx_dn19,rx_dn20,rx_dn21,rx_dn22,rx_dn23,rx_dn24,rx_dn25,rx_dn26,rx_dn27,rx_dn28,rx_dn29,rx_dn30,rx_dn31,rx_dn32,rx_dn33,rx_dn34,rx_dn35,rx_dn36,rx_dn37,rx_dn38,rx_dn39,rx_dn40,rx_dn41,rx_dn42,rx_dn43,rx_dn44,rx_dn45,rx_dn46,rx_dn47,rx_dn48,rx_dn49,rx_dn50,rx_dn51,rx_dn52,rx_dn53,rx_dn54,rx_dn55,rx_dn56,rx_dn57,rx_dn58,rx_dn59,rx_dn60,rx_dn61,rx_dn62,rx_dn63,rx_dn64,rx_dn65,rx_dn66,rx_dn67,rx_dn68,rx_dn69,rx_dn70,rx_dn71,rx_dn72;
//has ka
dualN E2;
assignD(&E2,add2(k20,k23,&rx_dn0));
dualN E3;
assignD(&E3,k32);
dualN s;
assignD(&s,add2X(add2(k23,k32,&rx_dn0),k20));
dualN beta;
assignD(&beta,prodd2X(0.5,(subtr2X2(&s,sqrtDX(subtr2X(prod2(&s,&s,&rx_dn0),prod2X(prodd2(4,k32,&rx_dn1),k20)))))));
dualN alpha;
assignD(&alpha,div2X(prod2(k20,k32,&rx_dn0),&beta));
dualN eA;
assignD(&eA,div2X(expDX(prodd2X(((*tau)-(*tinf)),negD(&alpha,&rx_dn0))),(subtrd2X(1,expDX(prod2dX(negD(&alpha,&rx_dn1),(*tau)))))));
dualN eB;
assignD(&eB,div2X(expDX(prodd2X(((*tau)-(*tinf)),negD(&beta,&rx_dn0))),(subtrd2X(1,expDX(prod2dX(negD(&beta,&rx_dn1),(*tau)))))));
dualN eiA;
assignD(&eiA,expDX(prod2dX(negD(&alpha,&rx_dn0),(*tinf))));
dualN eiB;
assignD(&eiB,expDX(prod2dX(negD(&beta,&rx_dn0),(*tinf))));
dualN alpha2;
assignD(&alpha2,prod2(&alpha,&alpha,&rx_dn0));
dualN alpha3;
assignD(&alpha3,prod2(&alpha,&alpha2,&rx_dn0));
dualN beta2;
assignD(&beta2,prod2(&beta,&beta,&rx_dn0));
dualN beta3;
assignD(&beta3,prod2(&beta,&beta2,&rx_dn0));
dualN A1;
iniD(0, -1, &A1);
dualN A2;
assignD(&A2,div2X((subtr2X(prod2X2(&eA,(add2X(subtr2X(prod2X2(&E3,(add2X(subtr2X(div2X(prodd2((*r2),k32,&rx_dn0),(prod2(&alpha,&beta,&rx_dn1))),div2X(prod2X(prod2d(&eiA,(*r2),&rx_dn2),(add2X(add2X(prod2X(negD(k32,&rx_dn3),&alpha),prod2X2(ka,(add2X(negD(&alpha,&rx_dn4),k32)))),&alpha2))),(add2X(add2X(prod2X(negD(&beta,&rx_dn5),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn6),&alpha2)))),&alpha3)))),div2X(prod2X(prod2d(&eiB,(*r2),&rx_dn7),(add2X(add2X(prod2X(negD(k32,&rx_dn8),&beta),prod2X2(ka,(add2X(negD(&beta,&rx_dn9),k32)))),&beta2))),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn10),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn11),&alpha),&beta2)))),&beta3)))))),prod2X2(&alpha,(add2X(subtr2X(div2X(prodd2((*r2),k32,&rx_dn12),(prod2(&alpha,&beta,&rx_dn13))),div2X(prod2X(prod2d(&eiA,(*r2),&rx_dn14),(add2X(add2X(prod2X(negD(k32,&rx_dn15),&alpha),prod2X2(ka,(add2X(negD(&alpha,&rx_dn16),k32)))),&alpha2))),(add2X(add2X(prod2X(negD(&beta,&rx_dn17),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn18),&alpha2)))),&alpha3)))),div2X(prod2X(prod2d(&eiB,(*r2),&rx_dn19),(add2X(add2X(prod2X(negD(k32,&rx_dn20),&beta),prod2X2(ka,(add2X(negD(&beta,&rx_dn21),k32)))),&beta2))),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn22),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn23),&alpha),&beta2)))),&beta3))))))),prod2X2(k32,(add2X(subtr2X(div2X(prodd2((*r2),k23,&rx_dn24),(prod2(&alpha,&beta,&rx_dn25))),div2X(prod2X(prod2d(&eiA,(*r2),&rx_dn26),(add2X(prod2X(negD(k23,&rx_dn27),&alpha),prod2(k23,ka,&rx_dn28)))),(add2X(add2X(prod2X(negD(&beta,&rx_dn29),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn30),&alpha2)))),&alpha3)))),div2X(prod2X(prod2d(&eiB,(*r2),&rx_dn31),(add2X(prod2X(negD(k23,&rx_dn32),&beta),prod2(k23,ka,&rx_dn33)))),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn34),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn35),&alpha),&beta2)))),&beta3))))))))),prod2X2(&eB,(add2X(subtr2X(prod2X2(&E3,(add2X(subtr2X(div2X(prodd2((*r2),k32,&rx_dn36),(prod2(&alpha,&beta,&rx_dn37))),div2X(prod2X(prod2d(&eiA,(*r2),&rx_dn38),(add2X(add2X(prod2X(negD(k32,&rx_dn39),&alpha),prod2X2(ka,(add2X(negD(&alpha,&rx_dn40),k32)))),&alpha2))),(add2X(add2X(prod2X(negD(&beta,&rx_dn41),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn42),&alpha2)))),&alpha3)))),div2X(prod2X(prod2d(&eiB,(*r2),&rx_dn43),(add2X(add2X(prod2X(negD(k32,&rx_dn44),&beta),prod2X2(ka,(add2X(negD(&beta,&rx_dn45),k32)))),&beta2))),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn46),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn47),&alpha),&beta2)))),&beta3)))))),prod2X2(&beta,(add2X(subtr2X(div2X(prodd2((*r2),k32,&rx_dn48),(prod2(&alpha,&beta,&rx_dn49))),div2X(prod2X(prod2d(&eiA,(*r2),&rx_dn50),(add2X(add2X(prod2X(negD(k32,&rx_dn51),&alpha),prod2X2(ka,(add2X(negD(&alpha,&rx_dn52),k32)))),&alpha2))),(add2X(add2X(prod2X(negD(&beta,&rx_dn53),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn54),&alpha2)))),&alpha3)))),div2X(prod2X(prod2d(&eiB,(*r2),&rx_dn55),(add2X(add2X(prod2X(negD(k32,&rx_dn56),&beta),prod2X2(ka,(add2X(negD(&beta,&rx_dn57),k32)))),&beta2))),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn58),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn59),&alpha),&beta2)))),&beta3))))))),prod2X2(k32,(add2X(subtr2X(div2X(prodd2((*r2),k23,&rx_dn60),(prod2(&alpha,&beta,&rx_dn61))),div2X(prod2X(prod2d(&eiA,(*r2),&rx_dn62),(add2X(prod2X(negD(k23,&rx_dn63),&alpha),prod2(k23,ka,&rx_dn64)))),(add2X(add2X(prod2X(negD(&beta,&rx_dn65),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn66),&alpha2)))),&alpha3)))),div2X(prod2X(prod2d(&eiB,(*r2),&rx_dn67),(add2X(prod2X(negD(k23,&rx_dn68),&beta),prod2(k23,ka,&rx_dn69)))),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn70),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn71),&alpha),&beta2)))),&beta3))))))))))),(add2X(negD(&alpha,&rx_dn72),&beta))));
dualN A3;
assignD(&A3,div2X((subtr2X(prod2X2(&eA,(add2X(subtr2X(prod2X2(&E2,(add2X(subtr2X(div2X(prodd2((*r2),k23,&rx_dn0),(prod2(&alpha,&beta,&rx_dn1))),div2X(prod2X(prod2d(&eiA,(*r2),&rx_dn2),(add2X(prod2X(negD(k23,&rx_dn3),&alpha),prod2(k23,ka,&rx_dn4)))),(add2X(add2X(prod2X(negD(&beta,&rx_dn5),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn6),&alpha2)))),&alpha3)))),div2X(prod2X(prod2d(&eiB,(*r2),&rx_dn7),(add2X(prod2X(negD(k23,&rx_dn8),&beta),prod2(k23,ka,&rx_dn9)))),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn10),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn11),&alpha),&beta2)))),&beta3)))))),prod2X2(&alpha,(add2X(subtr2X(div2X(prodd2((*r2),k23,&rx_dn12),(prod2(&alpha,&beta,&rx_dn13))),div2X(prod2X(prod2d(&eiA,(*r2),&rx_dn14),(add2X(prod2X(negD(k23,&rx_dn15),&alpha),prod2(k23,ka,&rx_dn16)))),(add2X(add2X(prod2X(negD(&beta,&rx_dn17),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn18),&alpha2)))),&alpha3)))),div2X(prod2X(prod2d(&eiB,(*r2),&rx_dn19),(add2X(prod2X(negD(k23,&rx_dn20),&beta),prod2(k23,ka,&rx_dn21)))),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn22),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn23),&alpha),&beta2)))),&beta3))))))),prod2X2(k23,(add2X(subtr2X(div2X(prodd2((*r2),k32,&rx_dn24),(prod2(&alpha,&beta,&rx_dn25))),div2X(prod2X(prod2d(&eiA,(*r2),&rx_dn26),(add2X(add2X(prod2X(negD(k32,&rx_dn27),&alpha),prod2X2(ka,(add2X(negD(&alpha,&rx_dn28),k32)))),&alpha2))),(add2X(add2X(prod2X(negD(&beta,&rx_dn29),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn30),&alpha2)))),&alpha3)))),div2X(prod2X(prod2d(&eiB,(*r2),&rx_dn31),(add2X(add2X(prod2X(negD(k32,&rx_dn32),&beta),prod2X2(ka,(add2X(negD(&beta,&rx_dn33),k32)))),&beta2))),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn34),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn35),&alpha),&beta2)))),&beta3))))))))),prod2X2(&eB,(add2X(subtr2X(prod2X2(&E2,(add2X(subtr2X(div2X(prodd2((*r2),k23,&rx_dn36),(prod2(&alpha,&beta,&rx_dn37))),div2X(prod2X(prod2d(&eiA,(*r2),&rx_dn38),(add2X(prod2X(negD(k23,&rx_dn39),&alpha),prod2(k23,ka,&rx_dn40)))),(add2X(add2X(prod2X(negD(&beta,&rx_dn41),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn42),&alpha2)))),&alpha3)))),div2X(prod2X(prod2d(&eiB,(*r2),&rx_dn43),(add2X(prod2X(negD(k23,&rx_dn44),&beta),prod2(k23,ka,&rx_dn45)))),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn46),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn47),&alpha),&beta2)))),&beta3)))))),prod2X2(&beta,(add2X(subtr2X(div2X(prodd2((*r2),k23,&rx_dn48),(prod2(&alpha,&beta,&rx_dn49))),div2X(prod2X(prod2d(&eiA,(*r2),&rx_dn50),(add2X(prod2X(negD(k23,&rx_dn51),&alpha),prod2(k23,ka,&rx_dn52)))),(add2X(add2X(prod2X(negD(&beta,&rx_dn53),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn54),&alpha2)))),&alpha3)))),div2X(prod2X(prod2d(&eiB,(*r2),&rx_dn55),(add2X(prod2X(negD(k23,&rx_dn56),&beta),prod2(k23,ka,&rx_dn57)))),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn58),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn59),&alpha),&beta2)))),&beta3))))))),prod2X2(k23,(add2X(subtr2X(div2X(prodd2((*r2),k32,&rx_dn60),(prod2(&alpha,&beta,&rx_dn61))),div2X(prod2X(prod2d(&eiA,(*r2),&rx_dn62),(add2X(add2X(prod2X(negD(k32,&rx_dn63),&alpha),prod2X2(ka,(add2X(negD(&alpha,&rx_dn64),k32)))),&alpha2))),(add2X(add2X(prod2X(negD(&beta,&rx_dn65),&alpha2),prod2X2(ka,(subtr2X(prod2(&alpha,&beta,&rx_dn66),&alpha2)))),&alpha3)))),div2X(prod2X(prod2d(&eiB,(*r2),&rx_dn67),(add2X(add2X(prod2X(negD(k32,&rx_dn68),&beta),prod2X2(ka,(add2X(negD(&beta,&rx_dn69),k32)))),&beta2))),(subtr2X(add2X(prod2(&alpha,&beta2,&rx_dn70),prod2X2(ka,(add2X(prod2X(negD(&beta,&rx_dn71),&alpha),&beta2)))),&beta3))))))))))),(add2X(negD(&alpha,&rx_dn72),&beta))));
A[0] = A1.f;
A[1] = A2.f;
A[2] = A3.f;
A[3] = A1.grad[dKa];
A[4] = A1.grad[dP1];
A[5] = A1.grad[dP2];
A[6] = A1.grad[dP3];
A[7] = A1.grad[dV1];
A[8]  = A2.grad[dKa];
A[9]  = A2.grad[dP1];
A[10] = A2.grad[dP2];
A[11] = A2.grad[dP3];
A[12] = A2.grad[dV1];
A[13] = A3.grad[dKa];
A[14] = A3.grad[dP1];
A[15] = A3.grad[dP2];
A[16] = A3.grad[dP3];
A[17] = A3.grad[dV1];
return A2;
}
static inline dualN twoCmtKaRateG(double *A, double *Alast, double *t, double *b1, double *b2, double *r1, double *r2, dualN *ka, dualN *k20, dualN *k23, dualN *k32) {
dualN rx_dn0,rx_dn1,rx_dn2,rx_dn3,rx_dn4,rx_dn5,rx_dn6,rx_dn7,rx_dn8,rx_dn9,rx_dn10,rx_dn11,rx_dn12,rx_dn13,rx_dn14,rx_dn15,rx_dn16,rx_dn17,rx_dn18,rx_dn19,rx_dn20,rx_dn21,rx_dn22,rx_dn23,rx_dn24,rx_dn25,rx_dn26,rx_dn27,rx_dn28,rx_dn29,rx_dn30;
// has ka
dualN A1last;
A1last.f =Alast[0];
A1last.grad[dKa] = Alast[3];
A1last.grad[dP1] = Alast[4];
A1last.grad[dP2] = Alast[5];
A1last.grad[dP3] = Alast[6];
A1last.grad[dV1] = Alast[7];
dualN A2last;
A2last.f = Alast[1];
A2last.grad[dKa] = Alast[8];
A2last.grad[dP1] = Alast[9];
A2last.grad[dP2] = Alast[10];
A1last.grad[dP3] = Alast[11];
A1last.grad[dV1] = Alast[12];
dualN A3last;
A3last.f = Alast[2];
A3last.grad[dKa] = Alast[13];
A3last.grad[dP1] = Alast[14];
A3last.grad[dP2] = Alast[15];
A3last.grad[dP3] = Alast[16];
A3last.grad[dV1] = Alast[17];
dualN E2;
assignD(&E2,add2(k20,k23,&rx_dn0));
dualN s;
assignD(&s,add2X(add2(k23,k32,&rx_dn0),k20));
dualN beta;
assignD(&beta,prodd2X(0.5,(subtr2X2(&s,sqrtDX(subtr2X(prod2(&s,&s,&rx_dn0),prod2X(prodd2(4,k32,&rx_dn1),k20)))))));
dualN alpha;
assignD(&alpha,div2X(prod2(k20,k32,&rx_dn0),&beta));
dualN eKa;
assignD(&eKa,expDX(prod2dX(negD(ka,&rx_dn0),(*t))));
dualN eA;
assignD(&eA,expDX(prod2dX(negD(&alpha,&rx_dn0),(*t))));
dualN eB;
assignD(&eB,expDX(prod2dX(negD(&beta,&rx_dn0),(*t))));
dualN ka2;
assignD(&ka2,prod2(ka,ka,&rx_dn0));
dualN alpha2;
assignD(&alpha2,prod2(&alpha,&alpha,&rx_dn0));
dualN alpha3;
assignD(&alpha3,prod2(&alpha,&alpha2,&rx_dn0));
dualN beta2;
assignD(&beta2,prod2(&beta,&beta,&rx_dn0));
dualN beta3;
assignD(&beta3,prod2(&beta,&beta2,&rx_dn0));
dualN A1;
assignD(&A1,subtr2X(addd2X((*b1),divd2((*r1),ka,&rx_dn0)),div2X((prod2X((subtrd2X((*r1),prod2(ka,&A1last,&rx_dn1))),&eKa)),ka)));
dualN A2;
assignD(&A2,add2X(subtr2X(add2X(addd2X((*b2),div2X((prod2X((add2X(subtr2X(prod2dX((subtr2(ka,k32,&rx_dn0)),(*r1)),prod2(&ka2,&A1last,&rx_dn1)),prod2X(prod2(k32,&A1last,&rx_dn2),ka))),&eKa)),(add2X(add2X2(&ka2,prod2X((subtr2X(negD(&beta,&rx_dn3),&alpha)),ka)),prod2(&beta,&alpha,&rx_dn4))))),div2X((prod2X((subtr2X(add2X(add2X(add2X(prod2dX((add2X(subtr2X(prod2X((subtr2(k32,&beta,&rx_dn5)),ka),prod2(k32,&beta,&rx_dn6)),&beta2)),(*r2)),prod2dX(prod2X((subtr2(k32,&beta,&rx_dn7)),ka),(*r1))),prod2X((add2X(prod2X(prod2X((subtr2X(subtr2X(negD(&A3last,&rx_dn8),&A2last),&A1last)),&beta),k32),prod2X((add2(&A2last,&A1last,&rx_dn9)),&beta2))),ka)),prod2X(prod2X((add2(&A3last,&A2last,&rx_dn10)),&beta2),k32)),prod2(&beta3,&A2last,&rx_dn11))),&eB)),(add2X(subtr2X(prod2X((subtr2X2(&beta2,prod2(&beta,&alpha,&rx_dn12))),ka),&beta3),prod2(&beta2,&alpha,&rx_dn13))))),div2X((prod2X((subtr2X(add2X(add2X(add2X(prod2dX((add2X(subtr2X(prod2X((subtr2(k32,&alpha,&rx_dn14)),ka),prod2(k32,&alpha,&rx_dn15)),&alpha2)),(*r2)),prod2dX(prod2X((subtr2(k32,&alpha,&rx_dn16)),ka),(*r1))),prod2X((add2X(prod2X(prod2X((subtr2X(subtr2X(negD(&A3last,&rx_dn17),&A2last),&A1last)),&alpha),k32),prod2X((add2(&A2last,&A1last,&rx_dn18)),&alpha2))),ka)),prod2X(prod2X((add2(&A3last,&A2last,&rx_dn19)),&alpha2),k32)),prod2(&alpha3,&A2last,&rx_dn20))),&eA)),(add2X(subtr2X(prod2X((subtr2X(prod2(&beta,&alpha,&rx_dn21),&alpha2)),ka),prod2(&beta,&alpha2,&rx_dn22)),&alpha3)))),div2X((add2X(prod2d(k32,(*r2),&rx_dn23),prod2d(k32,(*r1),&rx_dn24))),(prod2(&beta,&alpha,&rx_dn25)))));
dualN A3;
assignD(&A3,add2X(subtr2X(add2X(div2X(negDX((prod2X((subtr2X(prod2d(k23,(*r1),&rx_dn2),prod2X(prod2(k23,&A1last,&rx_dn3),ka))),&eKa))),(add2X(add2X2(&ka2,prod2X((subtr2X(negD(&beta,&rx_dn4),&alpha)),ka)),prod2(&beta,&alpha,&rx_dn5)))),div2X((prod2X((add2X(subtr2X(add2X(add2X(add2X(prod2dX((subtr2X(prod2(ka,k23,&rx_dn6),prod2(k23,&beta,&rx_dn7))),(*r2)),prod2dX(prod2(ka,k23,&rx_dn8),(*r1))),prod2X((subtr2X(add2X(prod2X(prod2X((subtr2X(negD(&A2last,&rx_dn9),&A1last)),&beta),k23),prod2(&beta2,&A3last,&rx_dn10)),prod2X(prod2(&E2,&A3last,&rx_dn11),&beta))),ka)),prod2X(prod2(&beta2,&A2last,&rx_dn12),k23)),prod2(&beta3,&A3last,&rx_dn13)),prod2X(prod2(&E2,&A3last,&rx_dn14),&beta2))),&eB)),(add2X(subtr2X(prod2X((subtr2X2(&beta2,prod2(&beta,&alpha,&rx_dn15))),ka),&beta3),prod2(&beta2,&alpha,&rx_dn16))))),div2X((prod2X((add2X(subtr2X(add2X(add2X(add2X(prod2dX((subtr2X(prod2(ka,k23,&rx_dn17),prod2(k23,&alpha,&rx_dn18))),(*r2)),prod2dX(prod2(ka,k23,&rx_dn19),(*r1))),prod2X((subtr2X(add2X(prod2X(prod2X((subtr2X(negD(&A2last,&rx_dn20),&A1last)),&alpha),k23),prod2(&alpha2,&A3last,&rx_dn21)),prod2X(prod2(&E2,&A3last,&rx_dn22),&alpha))),ka)),prod2X(prod2(&alpha2,&A2last,&rx_dn23),k23)),prod2(&alpha3,&A3last,&rx_dn24)),prod2X(prod2(&E2,&A3last,&rx_dn25),&alpha2))),&eA)),(add2X(subtr2X(prod2X((subtr2X(prod2(&beta,&alpha,&rx_dn26),&alpha2)),ka),prod2(&beta,&alpha2,&rx_dn27)),&alpha3)))),div2X((add2X(prod2d(k23,(*r2),&rx_dn28),prod2d(k23,(*r1),&rx_dn29))),(prod2(&beta,&alpha,&rx_dn30)))));
A[0] = A1.f;
A[1] = A2.f;
A[2] = A3.f;
A[3] = A1.grad[dKa];
A[4] = A1.grad[dP1];
A[5] = A1.grad[dP2];
A[6] = A1.grad[dP3];
A[7] = A1.grad[dV1];
A[8]  = A2.grad[dKa];
A[9]  = A2.grad[dP1];
A[10] = A2.grad[dP2];
A[11] = A2.grad[dP3];
A[12] = A2.grad[dV1];
A[13] = A3.grad[dKa];
A[14] = A3.grad[dP1];
A[15] = A3.grad[dP2];
A[16] = A3.grad[dP3];
A[17] = A3.grad[dV1];
return A2;
}
static inline dualN twoCmtKaSSb1G(double *A, double *tau, double *b1, dualN *ka, dualN *k20, dualN *k23, dualN *k32) {
dualN rx_dn0,rx_dn1,rx_dn2,rx_dn3,rx_dn4,rx_dn5,rx_dn6,rx_dn7,rx_dn8,rx_dn9;
//has ka
dualN E2;
assignD(&E2,add2(k20,k23,&rx_dn0));
dualN E3;
assignD(&E3,k32);
dualN e2e3;
assignD(&e2e3,add2(&E2,&E3,&rx_dn0));
dualN s;
assignD(&s,sqrtDX(subtr2X(prod2(&e2e3,&e2e3,&rx_dn0),prodd2X(4,(subtr2X(prod2(&E3,&E2,&rx_dn1),prod2(k32,k23,&rx_dn2)))))));
dualN lambda1;
assignD(&lambda1,prodd2X(0.5,(add2(&e2e3,&s,&rx_dn0))));
dualN lambda2;
assignD(&lambda2,prodd2X(0.5,(subtr2(&e2e3,&s,&rx_dn0))));
dualN eKa;
assignD(&eKa,divd2X(1,(subtrd2X(1,expDX(prodd2(-(*tau),ka,&rx_dn0))))));
dualN eL1;
assignD(&eL1,divd2X(1,(subtrd2X(1,expDX(prodd2(-(*tau),&lambda1,&rx_dn0))))));
dualN eL2;
assignD(&eL2,divd2X(1,(subtrd2X(1,expDX(prodd2(-(*tau),&lambda2,&rx_dn0))))));
dualN A1;
assignD(&A1,prod2d(&eKa,(*b1),&rx_dn0));
dualN A2;
assignD(&A2,prod2X(prod2d(ka,(*b1),&rx_dn0),(add2X(add2X(div2X(prod2X2(&eL1,(subtr2(&E3,&lambda1,&rx_dn1))),(prod2X((add2X(negD(&lambda1,&rx_dn2),&lambda2)),(subtr2(ka,&lambda1,&rx_dn3))))),div2X(prod2X2(&eL2,(subtr2(&E3,&lambda2,&rx_dn4))),(prod2X((subtr2(&lambda1,&lambda2,&rx_dn5)),(subtr2(ka,&lambda2,&rx_dn6)))))),div2X(prod2X2(&eKa,(subtr2(&E3,ka,&rx_dn7))),(prod2X((add2X(negD(ka,&rx_dn8),&lambda2)),(add2X(negD(ka,&rx_dn9),&lambda1)))))))));
dualN A3;
assignD(&A3,prod2X(prod2X(prod2d(ka,(*b1),&rx_dn0),k23),(add2X(add2X(div2X2(&eL1,(prod2X((add2X(negD(&lambda1,&rx_dn1),&lambda2)),(subtr2(ka,&lambda1,&rx_dn2))))),div2X2(&eL2,(prod2X((subtr2(&lambda1,&lambda2,&rx_dn3)),(subtr2(ka,&lambda2,&rx_dn4)))))),div2X2(&eKa,(prod2X((add2X(negD(ka,&rx_dn5),&lambda2)),(add2X(negD(ka,&rx_dn6),&lambda1)))))))));
A[0] = A1.f;
A[1] = A2.f;
A[2] = A3.f;
A[3] = A1.grad[dKa];
A[4] = A1.grad[dP1];
A[5] = A1.grad[dP2];
A[6] = A1.grad[dP3];
A[7] = A1.grad[dV1];
A[8]  = A2.grad[dKa];
A[9]  = A2.grad[dP1];
A[10] = A2.grad[dP2];
A[11] = A2.grad[dP3];
A[12] = A2.grad[dV1];
A[13] = A3.grad[dKa];
A[14] = A3.grad[dP1];
A[15] = A3.grad[dP2];
A[16] = A3.grad[dP3];
A[17] = A3.grad[dV1];
return A2;
}
static inline dualN twoCmtKaSSb2G(double *A, double *tau, double *b2, dualN *ka, dualN *k20, dualN *k23, dualN *k32) {
dualN rx_dn0,rx_dn1,rx_dn2,rx_dn3,rx_dn4;
(void)(ka);
dualN E2;
assignD(&E2,add2(k20,k23,&rx_dn0));
dualN E3;
assignD(&E3,k32);
dualN e2e3;
assignD(&e2e3,add2(&E2,&E3,&rx_dn0));
dualN s;
assignD(&s,sqrtDX(subtr2X(prod2(&e2e3,&e2e3,&rx_dn0),prodd2X(4,(subtr2X(prod2(&E3,&E2,&rx_dn1),prod2(k32,k23,&rx_dn2)))))));
dualN lambda1;
assignD(&lambda1,prodd2X(0.5,(add2(&e2e3,&s,&rx_dn0))));
dualN lambda2;
assignD(&lambda2,prodd2X(0.5,(subtr2(&e2e3,&s,&rx_dn0))));
dualN eL1;
assignD(&eL1,divd2X(1,(subtrd2X(1,expDX(prodd2(-(*tau),&lambda1,&rx_dn0))))));
dualN eL2;
assignD(&eL2,divd2X(1,(subtrd2X(1,expDX(prodd2(-(*tau),&lambda2,&rx_dn0))))));
dualN A1;
iniD(0, -1, &A1);
dualN A2;
assignD(&A2,div2X((subtr2X(prod2X2(&eL1,(subtr2X(prodd2((*b2),&E3,&rx_dn0),prodd2((*b2),&lambda1,&rx_dn1)))),prod2X2(&eL2,(subtr2X(prodd2((*b2),&E3,&rx_dn2),prodd2((*b2),&lambda2,&rx_dn3)))))),(add2X(negD(&lambda1,&rx_dn4),&lambda2))));
dualN A3;
assignD(&A3,div2X((subtr2X(prod2X(prod2d(&eL1,(*b2),&rx_dn0),k23),prod2X(prod2d(&eL2,(*b2),&rx_dn1),k23))),(add2X(negD(&lambda1,&rx_dn2),&lambda2))));
A[0] = A1.f;
A[1] = A2.f;
A[2] = A3.f;
A[3] = A1.grad[dKa];
A[4] = A1.grad[dP1];
A[5] = A1.grad[dP2];
A[6] = A1.grad[dP3];
A[7] = A1.grad[dV1];
A[8]  = A2.grad[dKa];
A[9]  = A2.grad[dP1];
A[10] = A2.grad[dP2];
A[11] = A2.grad[dP3];
A[12] = A2.grad[dV1];
A[13] = A3.grad[dKa];
A[14] = A3.grad[dP1];
A[15] = A3.grad[dP2];
A[16] = A3.grad[dP3];
A[17] = A3.grad[dV1];
return A2;
}
#endif
